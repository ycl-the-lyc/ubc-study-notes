#import "../lib.typ": *
#show: setup.with(
  title: [MATH 256 _Differential Equations_],
  author: "Yecheng Liang",
)

#set math.vec(delim: "[")
#set math.mat(delim: "[")

#let oL = math.op[L]

= Differential Equations
#definition(title: [Differential Equation])[
  An equation that defines a function by giving a relationship between the function and its derivative.
]

#example[
  $
    y' + y = x.
  $
]

Integration is solving a trivial differential equation.

Given a first-order, linear differential equation, $dv(y, x) = a y$, a reasonable guess is $y = A e^(a x)$.
We can take any constant $A$ because the equation is linear.

== Seperable Equations Method
For non-linear differential equations, we would manipulate the equation so one side is expressed by $y$, the other by $x$ and $dd(x)$.
Then, integrating both sides gives us a relationship between $x$ and $y$.

#example[
  $
              dv(y, x) & = a y \
             dd(y) / y & = a dd(x) \
    integral dd(y) / y & = a integral dd(x) + C \
             ln abs(y) & = a x + C \
                     y & = e^(ln(abs(y))) \
                       & = e^(a x + C) \
                       & = e^c e^(a x) \
                       & = A e^(a x).
  $
]

== Integrating Factor Method
With a linear first-order equation, we can forcibly express it by only $x$.

Let $oL$ be an operator such that
$
  oL y & = (dv(, x) + p(x)) y \
       & = dv(y, x) + p(x) y \
       & = g(x).
$
So long as $p(x), g(x)$ are continuous, a solution exists.
And, if $oL y = 0$, we say the equation is homogeneous.

Let $F(x)$ be the _integrating factor_ such that
$
  F(x) dv(y, x) + F(x) p(x) y & = dv(, x) [F(x) y].
$
From the equatoion above we can see that, if we differentiate $F(x)$, we get itself multiplied by $p(x)$, looks much like our guess of exponential before.
Hence,
$
  F(x) & = e^(integral p(x) dd(x)).
$

Multiply $oL y$ by $F(x)$,
$
  e^(integral p(x) dd(x)) dv(y, x) + e^(integral p(x) dd(x)) p(x) y & = e^(integral p(x) dd(x)) g(x)
$
Notice that the LHS is differential of a product.
$
  dv(, x) [e^(integral p(x) dd(x)) y] & = e^(integral p(x) dd(x)) g(x) \
            e^(integral p(x) dd(x)) y & = integral e^(integral p(x) dd(x)) g(x) dd(x) + C \
                                    y & = e^(-integral p(x) dd(x)) (integral e^(integral p(x) dd(x)) g(x) dd(x) + C).
$

#problem[
  Solve
  $
    cases(
      oL y = y' + y = x,
      y(0) = 1
    )
  $

  #solution[
    Using the integral factor form, let
    $
       p(x) & = 1 \
       y(x) & = x \
      y'(x) & = 1.
    $
    Thus, we find the integrating factor to be
    $
      F(x) & = e^(integral p(x) dd(x)) \
           & = e^x.
    $
    Then, transform the equation by multiplying $F(x) = e^x$ to both sides.
    $
      e^x y' + e^x y & = [e^x y]' \
                     & = x e^x.
    $
    Notice that the LHS is differential of a product, undo the chain rule, we get
    $
      e^x y & = e^x x - e^x + C.
    $
    Don't forget the $C$ generated by the integrating both sides.

    Move the factor of integration to the RHS,
    $
      y & = x - 1 + C e^(-x)
    $
    Plug in $y(0) = 1$,
    $
      y(x) = x - 1 + 2e^(-x).
    $
  ]
]

#problem[
  Solve
  $
    oL y & = y' + y = sin(x).
  $

  #solution[
    Recall Euler's Equation,
    $
      e^(i x) = cos(x) + i sin(x).
    $

    Similar to the previous problem,
    $
          F(x) & = e^x oL y \
               & = [e^x y]' \
               & = e^x sin(x) \
      [e^x y]' & = Im e^((1 + i)x).
    $
    Integrate both sides,
    $
      e^x y & = Im e^((1 + i)x) / (1 + i) + C.
    $
    Turn the fraction term of RHS into proper form,
    $
      e^((1 + i)x) / (1 + i) & = (e^((1 + i)x) (1 - i)) / ((1 + i) (1 - i)) \
                             & = (e^((1 + i)x) (1 - i)) / 2.
    $
    Continue with the factor of integration method,
    $
      y & = Im (e^((1 + i)x) (1 - i) e^(-x)) / 2 + C e^(-x) \
        & = Im (e^(i x) (1 - i)) / 2 + C e^(-x) \
        & = Im ((cos(x) + i sin(x)) (1 - i)) / 2 + C e^(-x) \
        & = Im ((cos(x) - i^2 sin(x)) + (i sin(x) - i cos(x))) / 2 + C e^(-x) \
        & = Im ((cos(x) + sin(x)) + i (sin(x) - cos(x))) / 2 + C e^(-x) \
        & = (sin(x) - cos(x)) / 2 + C e^(-x).
    $
    No particular solution.
  ]
]

== Undetermined Coefficient Method
For a homogeneous linear equatoion, we can guess a particular solution, $y_p$.
- If $g(x) = x^n$, then $y_p = a_n x^n + a_(n-1) x^(n-1) + ... + a_1 x + a_0$.
- If $g(x) = e^(a x)$, then $y_p = A e^(a x)$.
- If $g(x) = sin(x) "or" cos(x)$, then $y_p = A cos(x) + B sin(x)$.
The guesses are linear combinations of all possible derivatives of $g(x)$.

The particular solution still carries undetermined coefficients.
Assume this $y_p$ to transform $oL y$.

= Higher Order ODEs

== Linear Second-order ODEs
Redefine the operator $oL$:
$
  oL y & := y'' + p(x) y' + q(x) y = g(x).
$
If $g(x) = 0$, we say the equation is homogeneous.

Such equations are common in superposition of waves and such.

== Constant Coefficient Equations
If $g(x) = 0$ and the coefficients are constant, like
$
  oL y = a y'' + b y' + c y = 0,
$
then,
$
     y & = e^(r x) \
  oL y & = (a r^2 + b r + c) e^(r x) = 0.
$

Since $e^(r x) eq.not 0$, solving the equation is the same as solving the contained quadratic equation.
If $Delta < 0$, then the roots are complex,
$
  r_(1, 2) & = lambda plus.minus i mu \
      y(x) & = e^(r x) (A cos(mu x) + B sin(mu x))
$

#problem[
  A stone thrown vertically up at speed $v_0$ at height $h$.
  Express its displacement as a function of $t$.

  #solution[
    $
                     y'' & = -g \
      integral y'' dd(t) & = integral -g dd(t) \
                      y' & = -g t + C \
                   y'(0) & = v_0 = C \
       integral y' dd(t) & = integral -g t + v_0 dd(t) \
                       y & = v_0 t - 1/2 g t^2 + D \
                    y(0) & = h = D \
                    y(t) & = h + v_0 t - 1/2 g t^2.
    $
  ]
]

== Initial Value Problem
With similar setup to the previous problem, but the coefficients may not be constants.

Given $oL y = 0$ and initial conditions $y(x_0) = y_0, y'(x_0) = v_0$, let $y_1(x), y_2(x)$ be two solutions to $oL y = 0$.
Since $oL$ is a linear operation, its solution is also linear.
$
     y(x) & = C_1 y_1(x) + C_2 y_2(x) \
   y(x_0) & = C_1 y_1(x_0) + C_2 y_2(x_0) \
          & = y_0 \
  y'(x_0) & = C_1 y'_1(x_0) + C_2 y'_2(x_0) \
          & = v_0.
$
This can be written as
$
  underbrace(mat(y_1(x_0), y_2(x_0); y'_1(x_0), y'_2(x_0)), A) mat(C_1; C_2) = mat(y_0; v_0).
$

For it to be solved as having constant coefficients, $det(A) eq.not 0$, i.e. $A^(-1)$ must exist.

#definition(title: [Wronsian Function])[
  Given $y_1(x), y_2(x)$,
  $
    W(y_1, y_2)(x) := mdet(y_1(x), y_2(x); y'_1(x), y'_2(x)).
  $
]

#definition(title: [Fundamental Set of Solutions])[
  Given $oL y = y'' + p(x) y' + q(x) y = 0$, the pair ${y_1(x), y_2(x)}$ is a set of fundamental solutions on an interval $I$, provided that $W(Y_1, y_2)(x_0)$ where $x_0 in I$.
]

So, an initial value problem has solution if $W(y_1, y_2)(x_0) eq.not 0$.

== Linear Dependency of Functions
Given two functions $f(x), g(x)$ which are valid on interval $I$, they are linearly dependent on $I$ if there exists non-zero $c_1, c_2$ such that
$
  c_1 y(x) + c_2 g(x) = 0.
$

If $y(x) = C_1 y_1(x) + C_2 y_2(x)$, then ${y_1, y_2}$ is a set of fundamental solutions.

== Simple Harmonic Motion
Second-order differential equations are common in problems where contributing factors also produce hindrances, like spring-mass and inductor-capacitor systems.

#example[
  Given a spring hanging a mass,
  $
    m dot.double(x) & = - m g - k x - beta dot(x) \
    m dot.double(x) + underbrace(beta dot(x), #[damping]) + underbrace(k x, #[energy\ storage]) & = underbrace(- m g, #[forcing]).
  $
]

When $beta = 0$, it is without damping, thus simple harmonic motion.

=== Free Undamped Oscillation
Ignore external influence ("free") and damping.

#example[
  $
                              g & = 0 \
                           beta & = 0 \
          m dot.double(x) + k x & = 0 \
                              x & = e^(r t) \
                        omega_0 & = sqrt(k/m) \
    dot.double(x) + omega_0^2 x & = 0 \
      (r^2 + omega_0^2) e^(r t) & = 0 \
                              r & = plus.minus i omega_0 \
                           y(t) & = A cos(omega_0 t) + B sin(omega_0 t) \
                                & = R cos(omega_0 t - phi) quad ("double angle") \
                                & = R cos(omega_0 t) cos(phi) + R sin(omega_0 t) sin(phi) \
                              A & = R cos(phi) \
                              B & = R sin(phi) \
                              R & = sqrt(A^2 + B^2) \
                          B / A & = tan(phi) \
                            phi & = tan^(-1)(B / A)
  $
]

=== Free Damped Oscillation
There is still no external forcing.

#example[
  $
                                      g & = 0 \
                                   beta & > 0 \
    m dot.double(x) + beta dot(x) + k x & = 0.
  $

  See this as a constant coefficient equation,
  $
                  x(t) & = e^(r t) \
    m r^2 + beta r + k & = 0 \
                 Delta & = beta^2 + 4 m k \
                     r & = (-beta plus.minus sqrt(Delta)) / (2m).
  $

  If $Delta < 0$, then
  $
    r_(1, 2) & = - beta / (2m) plus.minus i sqrt(4 m k - beta^2) / (2m) \
             & = - beta / (2m) plus.minus omega_1
  $
  where
  $
    omega_1 & = sqrt((4 m k - beta^2) / (4m^2)) \
            & = sqrt(k/m - beta^2 / (4m^2)) \
            & = sqrt(k/m (1 - beta^2 / (4 m k))) \
            & = sqrt(k/m) sqrt(1 - beta^2 / (4 m k)) \
            & = omega_0 sqrt(1 - beta^2 / (4 m k)).
  $

  Substitute it back, plus Euler's equation,
  $
    x(t) = e^(- beta / (2m) t) [A cos(omega_1) t + B sin(omega_1) t]
  $
  which is an underdamp.

  If $Delta > 0$, then solve for $r_1, r_2$ as usual.
  Since $beta, m, k > 0$, the roots will be negative,
  $
    x(t) = A e^(r_1 t) + B e^(r_2 t)
  $
  which is an overdamp.

  If $Delta = 0$, then
  $
    beta^2 - 4 m k & = 0 \
              beta & = 2 sqrt(m k) \
                 r & = - beta / (2 m k) \
              x(t) & = e^(- beta / (2m)) [A + B t]
  $
  which is a critcal damp.
]

== Inhomogeneous Second-order Equations
Define
$
  oL y & = y'' + p(x) y' + q(x) y = g(x)
$
where $g(x) eq.not 0$.

It has the general solution of
$
  y(x) & = y_P (x) + y_H (x)
$
where $oL y_P (x) = g(x), oL y_H (x) = 0$.

If $g(x) = 0$, then $y_P$ disappears, then we can solve the constant coefficient cases as usual.
$
              y_H & = e^(r x) \
  a r^2 + b r + c & = 0 \
                r & = ... \
             y(x) & = y_H (x) = c_1 y_1 (x) + c_2 y_2 (x).
$

To find $y_P$, we guess it to be a linear combination of all possible derivatives of $g(x)$.
- $x^n$: $y_P = a_n x^n + a_(n-1) x^(n-1) + ... + a_1 x + a_0$.
- $e^(a x)$: $y_P = A e^(a x)$.
- $sin(omega x), cos(omega x)$: $y_P = A cos(omega x) + B sin(omega x)$.

#note-box[
  This does not work when one or more terms of $y_P$ is a solution to the homogeneous equation.
  To make it work, we multiply the guess of $y_P$ by one or more $x$, until the highest power of $oL y_P$ matches the ones in $g(x)$.
]

#problem[
  Solve $oL y = y'' + 3y' + 2y = e^x$.

  #solution[
    Guess $y_P = A e^x$.
    Solve for $y_H$ (omitted).
    $
       oL y_P & = A e^x + 3 A e^x + 2 A e^x = e^x \
      6 A e^x & = e^x \
            A & = 1/6.
    $
    Combine $y_P, y_H$,
    $
      y(x) & = 1/6 e^x + c_1 e^(-x) + c_2 e^(-2 x).
    $
  ]
]

== Forced Oscillations and Resonnance
For all periodic motions, we can write them into some
$
  m x'' + c x' + k x = F_0 cos(omega t).
$

=== Undamped Forced Motion and Resonnance
Since it is undamped, $c = 0$.

Recall that our spring-mass system has the homogeneous solution of
$
  x_H = C_1 cos(omega_0 t) + C_2 sin(omega_0 t)
$
where $omega_0 = sqrt(k/m)$ is the _natural frequency_.

If $omega eq.not omega_0$, we know $x_p = A cos(omega t)$ where $A$ is some constant.
Solve for $x_p$,
$
  x_P = F_0 / (m (omega_0^2 - omega^2)) cos(omega t).
$

The general solution is thus the linear combination of $x_h$ and $x_p$:
$
  x = C_1 cos(omega_0 t) + C_2 sin(omega_0 t) + F_0 / (m (omega_0^2 - omega^2)) cos(omega t).
$

=== Damped Forced Motion and Partial Resonnance
Let
$
        p & = c / (2m) \
  omega_0 & = sqrt(k/m).
$
Then,
$
  oL x_P = & dot.double(x_P) + beta / m dot(x_P) + k / m x_P = F_0 / m cos(omega t) \
         = & -omega^2 [A cos(omega t) + B sin(omega t)] \
           & + k / m [-A omega sin(omega t) + B omega cos(omega t)] \
           & + [A cos(omega t) + B sin(omega t)] \
         = & (omega_0^2 - omega^2) [A cos(omega t) + B sin(omega t)] \
           & + beta / m [-A omega sin(omega t) + B omega cos(omega t)] \
         = & cos(omega t) [A (omega_0^2 - omega^2) + B (omega beta) / m] \
           & + sin(omega t) [B (omega_0^2 - omega^2) - A (omega beta) / m].
$

Equate the first and last line, we know that the $sin... = 0, cos... = F_0 / m$.
So solve for $A, B$ (omitted).

Let $R = sqrt(A^2 + B^2)$, we can combine the $sin$ and $cos$ terms
$
  x_P (t) = & R cos(omega t - phi)
$
where $phi = tan^-1 (((omega beta) / m) / (omega_0^2 - omega^2))$.

== Cauchy-Euler Equation
Define
$
  oL y = & a x^2 y'' + b x y' + c y = 0
$
where $a, b, c$ are constants.

If $a = 0$, the equation becomes first-order and seperable.
$
  ln abs(y) = & - c / b ln abs(x) + D \
       y(x) = & e^(ln abs(y)) \
            = & e^(ln abs(x))^(-c/b) e^D \
            = & A x^(-c/b).
$

For the second-order equatoion, we guess that
$
        y = & x^r \
       y' = & r x^(r - 1) \
      y'' = & r (r - 1) x^(r - 2) \
     x y' = & r x^r \
  x^2 y'' = & r (r - 1) x^r.
$

Apply $oL$ on this guess: for all $x$,
$
               oL x^r = & [a r (r - 1) + b r + c] x^r \
                        & = 0 \
  a r^2 + (b - a) r + c & = 0.
$

Then solve it in similar fasion to the previous second-order equations.
- If $Delta > 0$,
  $
    y(x) = & C_1 x^(r_1) + C_2 x^(r_2).
  $
- If $Delta < 0$,
  $
    r_(1, 2) = & - (b - a) / (2 a) plus.minus ((-1) (4 a c - (b - a)^2)) \
             = & alpha plus.minus i beta
  $
  where $alpha, beta$ are obvious.
  $
    y(x) = & C_1 x^(alpha + i beta) + C_2 x^(alpha - i beta) \
         = & x^alpha [C_1 e^(i beta ln(x)) + C_2 e^(-i beta ln(x))] \
         = & x^alpha [A cos(beta ln(x)) + B sin(beta ln(x))].
  $
- If $Delta = 0$, the one repeated root $r = - (b - a) / (2 a)$.
  One solution is
  $
    y_1 (x) = x^r.
  $
  The other can be found via
  $
    y_2 (x) = & evaluated(pdv(, r) x^r)_(r = r_1) \
            = & evaluated(pdv(, r) e^(r ln(x)))_(r = r_1) \
            = & x^r ln(x).
  $
  This method is explained in the next section.
  $y(x)$ is then a linear combination of the two solutions.

// TODO
// $
//   oL x^r = & [a x^2 dv(, x, 2) + b x dv(, x) + c] x^r \
//          = & [a r^2 + (b - a) r + c] x^2 \
//          = & a [(r + (b - a) / (2a))^2 - overbrace((b - a)^2 - 4 a c, Delta = 0) / (4 a^2)] x^2 \
//          = & a (r + (b - a) / (2a))^2 x^r
// $
//
// $
//   oL(evaluated(pdv(x^r, r))_(r = 1)) = & 0.
// $

== Reduction of Order Method
Given the second-order differential equation.
If $y_1 (x)$ is a solution to the homogeneous equation, then the other solution $y_2 (x)$ can be found in form of
$
    y_2 (x) = & u(x) y_1 (x) \
   y'_2 (x) = & u(x) y'_1 (x) + u' (x) + y_1 (x) \
  y''_2 (x) = & u(x) y''_1 (x) + 2 u' (x) y'_1 (x) + u'' (x) + y_1 (x).
$
Since we know $oL y_1 = 0$, we can strip it from the expression of $oL y_2$:
$
  oL y_2 = & y''_2 + p(x) y'_2 + q(x) y_2 = g(x) \
         = & underbrace(u [y''_1 + p(x) y'_1 + q(x) y_1], oL y_1 = 0) + [u'' y_1 + (2 u' y_1 + p y_1 u')] \
         = & u'' y_1 + (2 u' y_1 + p y_1 u').
$
Let $W = u', W'' = u''$,
$
  W' + ((2 y'_1) / y_1 + p(x)) W = & g(x) / (y_1 (x)).
$
Go back to using the integrating factor method,
$
                 F(x) = & e^(2 integral y'_1 / y_1 dd(x) + integral p(x) dd(x)) \
                      = & e^(ln(y_1^2) + integral p(x) dd(x)) \
                      = & y_1^2 e^(integral p(x) dd(x)) \
  dv(, x) [F(x) W(x)] = & (F(x) g(x)) / (y_1 (x)) \
            F(x) W(x) = & integral (F(x) g(x)) / (y_1 (x)) dd(x) + C_2 \
        W(x) = u' (x) = & 1 / F(x) integral (F(x) g(x)) / (y_1 (x)) dd(x) + C_2 / F(x) \
                 u(x) = & C_2 integral 1 / F(x) dd(x) \
                        & + limits(integral)^x 1 / F(s) [limits(integral)^s (F(t) g(t)) / (y_1 (t)) dd(t)] dd(s) \
                 y(x) = & C_1 y_1 (x) + u(x) y_1 (x).
$

#problem[
  Solve
  $
    oL y = & x^2 y'' + x y' - 9 y = 0.
  $

  #solution[
    Let $y = x^r$.
    $
                   oL x^r = & [a r (r - 1) + b r + c] x^r \
                            & = 0 \
      a r^2 + (b - a) r + c & = 0
    $
    where $a = 1, b = 1, c = -9$.
    $
         Delta = & (b - a)^2 - 4 a c \
               = & 36 > 0; \
      r_(1, 2) = & (plus.minus sqrt(Delta)) / 2 \
               = & plus.minus 3 \
          y(x) = & C_1 x^3 + C_2 x^(-3).
    $
  ]
]

#problem[
  Solve
  $
    oL y = & x^2 y'' + x y' + 9 y = 0.
  $

  #solution[
    Similar to the previous problem,
    $
      r_(1, 2) = & plus.minus 3 i \
          y(x) = & C_1 cos(3 ln(x)) + C_2 sin(3 ln(x)).
    $
  ]
]

#problem[
  Solve
  $
    oL y = & x^2 y'' - x y' + y = 0.
  $

  #solution[
    $Delta = 0, r = 1$.
    $
      y(x) = & C_1 x' + C_2 x' ln(x).
    $
  ]
]

